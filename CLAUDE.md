# EventMamba-FX Two-Step Event Generator Memory

## ğŸ¯ é¡¹ç›®æ ¸å¿ƒå®šä½
EventMamba-FX Two-Step Event Generatoræ˜¯ä¸€ä¸ª**è§£è€¦çš„äº‹ä»¶æ•°æ®ç”Ÿæˆç³»ç»Ÿ**ï¼Œé‡‡ç”¨ä¸¤æ­¥ç‹¬ç«‹æµç¨‹ç”Ÿæˆç‚«å…‰äº‹ä»¶å’Œåˆæˆäº‹ä»¶æ•°æ®ã€‚

**ğŸš€ é‡è¦ï¼šè¿™æ˜¯å…¨æ–°çš„two-stepæ¶æ„ï¼Œå®Œå…¨è§£è€¦ç‚«å…‰ç”Ÿæˆå’Œäº‹ä»¶åˆæˆï¼Œè¾“å‡ºæ ‡å‡†DVSæ ¼å¼H5æ–‡ä»¶ï¼Œç§»é™¤äº†æ‰€æœ‰ç‰¹å¾æå–å’Œæ ‡ç­¾ç”Ÿæˆã€‚**

## Environment Setup ğŸ”§ CRITICAL
- **MUST USE**: `source /home/lanpoknlanpokn/miniconda3/bin/activate event_flare`
- ç¯å¢ƒåŒ…å«å¿…éœ€ä¾èµ–ï¼šPyTorch, NumPy, H5py, OpenCV, YAML, tqdmç­‰
- Python 3.10.18ï¼Œæ— éœ€GPUï¼ˆæ•°æ®ç”Ÿæˆä¸ºCPUå¯†é›†å‹ï¼‰

## ğŸš€ ç³»ç»ŸçŠ¶æ€ï¼šä¸¤æ­¥è§£è€¦æ¶æ„ (2025-08-20 é‡æ„å®Œæˆ)

### âœ… æ–°æ¶æ„æ ¸å¿ƒç‰¹æ€§
- **Step 1**: ç‹¬ç«‹ç‚«å…‰äº‹ä»¶ç”Ÿæˆå™¨ â†’ `output/data/flare_events/*.h5`
- **Step 2**: äº‹ä»¶åˆæˆå™¨ â†’ `output/data/bg_events/*.h5` + `output/data/merge_events/*.h5`
- **æ ‡å‡†DVSæ ¼å¼**: `/events/t, /events/x, /events/y, /events/p`
- **æ— ç‰¹å¾æå–**: è¾“å‡ºåŸå§‹äº‹ä»¶æ•°æ®ï¼Œæ— ä»»ä½•åå¤„ç†
- **æ— æ ‡ç­¾ç”Ÿæˆ**: ç§»é™¤å¤æ‚çš„é€äº‹ä»¶æ ‡ç­¾ï¼Œä¸“æ³¨çº¯äº‹ä»¶æ•°æ®
- **å®Œå…¨è§£è€¦**: ä¸¤æ­¥å¯ç‹¬ç«‹è¿è¡Œï¼Œä¾¿äºè°ƒè¯•å’Œä¿®æ”¹

### ğŸ“Š æ–°è¾“å‡ºæ ¼å¼ (æ ‡å‡†DVS H5æ ¼å¼)
```bash
# Step 1 è¾“å‡ºï¼šçº¯ç‚«å…‰äº‹ä»¶
output/data/flare_events/flare_sequence_xxx.h5
â”œâ”€â”€ /events/t  [N] int64    # æ—¶é—´æˆ³ (å¾®ç§’)
â”œâ”€â”€ /events/x  [N] uint16   # Xåæ ‡
â”œâ”€â”€ /events/y  [N] uint16   # Yåæ ‡  
â””â”€â”€ /events/p  [N] int8     # ææ€§ (1/-1)

# Step 2 è¾“å‡ºï¼šèƒŒæ™¯äº‹ä»¶ + åˆå¹¶äº‹ä»¶
output/data/bg_events/composed_sequence_xxx_bg.h5      # èƒŒæ™¯äº‹ä»¶
output/data/merge_events/composed_sequence_xxx_merge.h5  # åˆå¹¶äº‹ä»¶
# åŒæ ·çš„ /events/* æ ¼å¼
```

### ğŸ® æ–°ä½¿ç”¨æ–¹å¼
```bash
# å®Œæ•´æµç¨‹
python main.py --debug

# åˆ†æ­¥æ‰§è¡Œ  
python main.py --step 1 --debug  # åªç”Ÿæˆç‚«å…‰äº‹ä»¶
python main.py --step 2 --debug  # åªåˆæˆäº‹ä»¶ (éœ€è¦Step1å…ˆå®Œæˆ)

# æµ‹è¯•ç³»ç»Ÿ
python test_new_system.py
```

## ğŸ—ï¸ æ–°æ¶æ„ç»„ä»¶

### ä¸»è¦æ–‡ä»¶ç»“æ„
```
EventMamba-FX-Two-Step-Generator/
â”œâ”€â”€ main.py                          # ä¸¤æ­¥æµç¨‹ä¸»å…¥å£ ğŸ†•
â”œâ”€â”€ test_new_system.py               # ç³»ç»Ÿæµ‹è¯•è„šæœ¬ ğŸ†•
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ config.yaml                  # ä¸¤æ­¥æ¨¡å¼é…ç½® ğŸ”„
â”œâ”€â”€ src/                             # æ ¸å¿ƒç»„ä»¶
â”‚   â”œâ”€â”€ flare_event_generator.py     # Step1: ç‹¬ç«‹ç‚«å…‰ç”Ÿæˆå™¨ ğŸ†•
â”‚   â”œâ”€â”€ event_composer.py            # Step2: äº‹ä»¶åˆæˆå™¨ ğŸ†•
â”‚   â”œâ”€â”€ flare_synthesis.py           # ç‚«å…‰å›¾åƒåˆæˆ âœ…
â”‚   â”œâ”€â”€ dvs_flare_integration.py     # DVSä»¿çœŸå™¨é›†æˆ âœ…
â”‚   â”œâ”€â”€ dsec_efficient.py            # DSECèƒŒæ™¯åŠ è½½ âœ…
â”‚   â”œâ”€â”€ event_visualization_utils.py # Debugå¯è§†åŒ– âœ…
â”‚   â””â”€â”€ [legacy files]               # æ—§æ–‡ä»¶ä¿ç•™ï¼Œä¸å†ä½¿ç”¨
â”œâ”€â”€ simulator/
â”‚   â””â”€â”€ DVS-Voltmeter-main/          # DVSç‰©ç†ä»¿çœŸå™¨ âœ…
â”œâ”€â”€ R_flare_generator/               # åå°„ç‚«å…‰ç”Ÿæˆå™¨ ğŸ†•
â”‚   â”œâ”€â”€ generate_UE.py               # UE5è‡ªåŠ¨åŒ–ç‚«å…‰è§†é¢‘ç”Ÿæˆè„šæœ¬
â”‚   â””â”€â”€ test_UE.py                   # UE5å±æ€§è¯Šæ–­æµ‹è¯•è„šæœ¬
â”œâ”€â”€ data/
â”‚   â””â”€â”€ bg_events/                   # DSECèƒŒæ™¯äº‹ä»¶(è¾“å…¥) âœ…
â””â”€â”€ output/
    â”œâ”€â”€ data/                        # æ–°è¾“å‡ºç»“æ„ ğŸ†•
    â”‚   â”œâ”€â”€ flare_events/            # Step1: çº¯ç‚«å…‰äº‹ä»¶
    â”‚   â”œâ”€â”€ bg_events/               # Step2: èƒŒæ™¯äº‹ä»¶
    â”‚   â””â”€â”€ merge_events/            # Step2: åˆå¹¶äº‹ä»¶
    â””â”€â”€ debug/                       # Debugå¯è§†åŒ– ğŸ†•
        â”œâ”€â”€ flare_generation/        # Step1 debug
        â””â”€â”€ event_composition/       # Step2 debug
```

### æ–°æ•°æ®æµç¨‹ (å®Œå…¨è§£è€¦)
```mermaid
graph TD
    subgraph "Step 1: ç‚«å…‰äº‹ä»¶ç”Ÿæˆ"
        A[Flare7Kå›¾åƒ] --> B[ç‚«å…‰åºåˆ—åˆæˆ]
        B --> C[DVSç‰©ç†ä»¿çœŸ]
        C --> D[çº¯ç‚«å…‰äº‹ä»¶]
        D --> E[flare_events/*.h5]
    end
    
    subgraph "Step 2: äº‹ä»¶åˆæˆ"
        F[DSECèƒŒæ™¯äº‹ä»¶] --> H[äº‹ä»¶åˆæˆå™¨]
        E --> H
        H --> I[bg_events/*.h5]
        H --> J[merge_events/*.h5]
    end
    
    subgraph "Debugå¯è§†åŒ–"
        D --> K[Step1 Debug]
        I --> L[Step2 Debug]
        J --> L
    end
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹ (æ¨è)
```bash
# æ¿€æ´»ç¯å¢ƒ
source /home/lanpoknlanpokn/miniconda3/bin/activate event_flare

# ğŸ†• å®Œæ•´ä¸¤æ­¥æµç¨‹ (æ¨è)
python main.py --debug

# ğŸ†• åˆ†æ­¥æ‰§è¡Œ
python main.py --step 1 --debug    # åªç”Ÿæˆç‚«å…‰äº‹ä»¶
python main.py --step 2 --debug    # åªåˆæˆäº‹ä»¶

# ğŸ†• ç³»ç»Ÿæµ‹è¯•
python test_new_system.py
```

### æ–°é…ç½®å‚æ•°è¯´æ˜
```yaml
# configs/config.yaml å…³é”®å‚æ•° (å·²æ›´æ–°)
generation:
  num_train_sequences: 10           # Step1: è®­ç»ƒç”¨ç‚«å…‰åºåˆ—æ•°
  num_val_sequences: 5              # Step1: éªŒè¯ç”¨ç‚«å…‰åºåˆ—æ•°  
  debug_sequences: 3                # Debugæ¨¡å¼åºåˆ—æ•°
  
  output_paths:
    flare_events: "output/data/flare_events"     # Step1è¾“å‡º
    bg_events: "output/data/bg_events"           # Step2è¾“å‡º
    merge_events: "output/data/merge_events"     # Step2è¾“å‡º

data:
  flare_synthesis:
    duration_range: [0.03, 0.08]                # ç‚«å…‰äº‹ä»¶æ—¶é•¿(ç§’)
    
# ğŸ†• æ—¶é—´çº¿è®¾è®¡ (100mså›ºå®šæ€»é•¿åº¦)
timing_design:
  flare_start_offset: [0, 20]ms                 # ç‚«å…‰éšæœºèµ·å§‹æ—¶é—´
  flare_duration: [30, 80]ms                    # ç‚«å…‰æŒç»­æ—¶é—´  
  total_sequence_length: 100ms                  # å›ºå®šæ€»é•¿åº¦
  background_length: 100ms                      # èƒŒæ™¯äº‹ä»¶é•¿åº¦(å›ºå®š)
```

## ğŸ“Š æ•°æ®ç”Ÿæˆè¯¦ç»†ä¿¡æ¯

### DSECèƒŒæ™¯äº‹ä»¶æ¥æº
- **æ–‡ä»¶ä½ç½®**: `data/bg_events/*.h5` (7ä¸ªæ–‡ä»¶)
- **æ•°æ®é‡**: 32.7äº¿äº‹ä»¶ï¼Œ291ä¸ª1ç§’æ—¶é—´çª—å£
- **éšæœºåŒ–**: 50-100mséšæœºæ—¶é—´çª—å£
- **æ–‡ä»¶åˆ—è¡¨**: interlaken_00_c.h5, interlaken_00_g.h5, thun_00_a.h5, zurich_city_00_a.h5, zurich_city_01_a.h5, zurich_city_04_a.h5, zurich_city_07_a.h5

### DVSç‚«å…‰äº‹ä»¶ä»¿çœŸ
- **ä»¿çœŸå™¨**: DVS-Voltmeterç‰©ç†ä»¿çœŸå™¨(å”¯ä¸€ä¿ç•™)
- **ä»¿çœŸå™¨è·¯å¾„**: `simulator/DVS-Voltmeter-main/`
- **å‚æ•°è®¾ç½®**: k1éšæœºåŒ– 5-16èŒƒå›´éšæœº (æ‰©å¤§äº‹ä»¶æ•°é‡å˜åŒ–èŒƒå›´), å®Œæ•´6å‚æ•°DVS346é…ç½®
- **æ—¶é—´çª—å£**: 30-80mséšæœºé•¿åº¦ + 0-20mséšæœºèµ·å§‹åç§»
- **å›¾åƒæº**: Flare7Kæ•°æ®é›†ï¼Œ5962å¼ ç‚«å…‰å›¾åƒ
- **é—ªçƒé¢‘ç‡**: 100-120HzåŸºé¢‘ Â±20Hzå˜åŒ– (æ›´å¤§å˜åŒ–èŒƒå›´)

### ğŸ†• åå°„ç‚«å…‰ç”Ÿæˆå™¨ (R_flare_generator)
- **ç›®æ ‡**: ç”Ÿæˆåå°„ç‚«å…‰ä»¿çœŸæ•°æ®ï¼Œè¡¥å……å½“å‰ç³»ç»Ÿçš„ç‚«å…‰ç±»å‹è¦†ç›–
- **æ ¸å¿ƒåŠŸèƒ½**: ç°æœ‰ç³»ç»Ÿåªèƒ½ç”Ÿæˆæ•£å°„ç‚«å…‰ï¼Œç¼ºå°‘åå°„ç‚«å…‰ç±»å‹
- **ä¸»è¦ç»„ä»¶**:
  - `GLSL_flare.py`: âœ… **GPUåŠ é€Ÿåå°„ç‚«å…‰ç”Ÿæˆå™¨** (ç”Ÿäº§å°±ç»ª)
    - åŸºäºGLSL shaderçš„å®æ—¶ç‚«å…‰ä»¿çœŸ
    - ç²¾ç¡®è§£è€¦æ§åˆ¶ï¼šå…‰æºè¾‰å…‰ vs åå°„é¬¼å½±
    - æ”¯æŒç¨‹åºåŒ–å™ªå£°çº¹ç† (500+ Perlin/Voronoi/çœŸå®çº¹ç†)
    - **ä¸“é—¨ç”¨äºè¡¥å……ç”Ÿæˆåå°„ç‚«å…‰ï¼Œä¸æ›¿æ¢ç°æœ‰Flare7Kæ–¹æ³•**
  - `generate_procedural_noise.py`: ç”Ÿæˆå¤šæ ·åŒ–å™ªå£°çº¹ç†åº“
  - `generate_UE.py`: UE5è‡ªåŠ¨åŒ–æ–¹æ¡ˆ (è¯•éªŒæš‚åœ)
  - `test_UE.py`: UE5è¯Šæ–­å·¥å…· (è¯•éªŒæš‚åœ)
- **è¾“å‡ºæ ¼å¼**: PNGå›¾åƒåºåˆ—ï¼Œä¸ç°æœ‰ç‚«å…‰å›¾åƒæ ¼å¼å…¼å®¹
- **çŠ¶æ€**: GLSLæ–¹æ¡ˆå·²å°±ç»ªï¼ŒUE5æ–¹æ¡ˆæš‚åœ

### æ–°è¾“å‡ºæ•°æ®æ ¼å¼ (æ ‡å‡†DVSæ ¼å¼)
```python
# ğŸ†• æ ‡å‡†DVS H5æ–‡ä»¶ç»“æ„ (æ‰€æœ‰è¾“å‡ºæ–‡ä»¶ç»Ÿä¸€æ ¼å¼)
/events/t: (N,) int64     # æ—¶é—´æˆ³ (å¾®ç§’ï¼Œ0-100msèŒƒå›´)
/events/x: (N,) uint16    # Xåæ ‡ (åƒç´ )
/events/y: (N,) uint16    # Yåæ ‡ (åƒç´ )  
/events/p: (N,) int8      # ææ€§ {1, -1} (DSECæ ¼å¼)

# ğŸ†• æ—¶é—´çº¿è®¾è®¡ (100msç»Ÿä¸€æ—¶é•¿)
flare_events/*.h5:    æ—¶é—´æˆ³èŒƒå›´ 0-100ms (éšæœºèµ·å§‹åç§»0-20ms)
bg_events/*.h5:       æ—¶é—´æˆ³èŒƒå›´ 0-100ms (å›ºå®š100msé•¿åº¦)  
merge_events/*.h5:    æ—¶é—´æˆ³èŒƒå›´ 0-100ms (èƒŒæ™¯+ç‚«å…‰åˆå¹¶)

# ğŸš« ç§»é™¤çš„è¾“å‡º
# - ä¸å†æœ‰featuresæ•°ç»„ (æ— ç‰¹å¾æå–)
# - ä¸å†æœ‰labelsæ•°ç»„ (æ— é€äº‹ä»¶æ ‡ç­¾)
# - ä¸å†æœ‰å½’ä¸€åŒ–å¤„ç† (è¾“å‡ºåŸå§‹æ•°æ®)
```

## ğŸ› ï¸ æ–°Debugæ¨¡å¼åŠŸèƒ½

### Step 1 Debugè¾“å‡º
```
output/debug/flare_generation/
â””â”€â”€ flare_sequence_XXX/
    â”œâ”€â”€ events_temporal_0.5x/    # å¤šåˆ†è¾¨ç‡äº‹ä»¶å¯è§†åŒ–
    â”œâ”€â”€ events_temporal_1x/      # (0.5x, 1x, 2x, 4x)
    â”œâ”€â”€ events_temporal_2x/
    â”œâ”€â”€ events_temporal_4x/
    â”œâ”€â”€ source_frames/           # åŸå§‹ç‚«å…‰å›¾åƒåºåˆ—
    â””â”€â”€ metadata.txt             # ç‚«å…‰ç”Ÿæˆå…ƒæ•°æ®
```

### Step 2 Debugè¾“å‡º  
```
output/debug/event_composition/
â””â”€â”€ composition_XXX/
    â”œâ”€â”€ background_events/       # èƒŒæ™¯äº‹ä»¶å¯è§†åŒ–
    â”‚   â”œâ”€â”€ temporal_0.5x/
    â”‚   â”œâ”€â”€ temporal_1x/
    â”‚   â”œâ”€â”€ temporal_2x/
    â”‚   â””â”€â”€ temporal_4x/
    â”œâ”€â”€ flare_events/           # ç‚«å…‰äº‹ä»¶å¯è§†åŒ–
    â”œâ”€â”€ merged_events/          # åˆå¹¶äº‹ä»¶å¯è§†åŒ–
    â””â”€â”€ composition_metadata.txt # åˆæˆç»Ÿè®¡ä¿¡æ¯
```

### å¯è§†åŒ–ç‰¹æ€§
- **å¤šåˆ†è¾¨ç‡æ—¶é—´çª—å£**: 0.5x, 1x, 2x, 4xæ—¶é—´å€æ•°åˆ†æ
- **äº‹ä»¶ç±»å‹é¢œè‰²ç¼–ç **: èƒŒæ™¯(çº¢/è“), ç‚«å…‰(é»„/æ©™), åˆå¹¶(ç™½/ç°)
- **PNGå¸§åºåˆ—**: æ¯ç§åˆ†è¾¨ç‡ç”Ÿæˆ30å¸§ä»¥å†…çš„å¯è§†åŒ–

## ğŸ“ˆ æ–°æ€§èƒ½æŒ‡æ ‡ (2025-08-20)

### ğŸ†• ä¸¤æ­¥æ¶æ„æ€§èƒ½é¢„æœŸ
- **Step 1 (ç‚«å…‰ç”Ÿæˆ)**: é¢„è®¡60-90ç§’/åºåˆ— (ç§»é™¤ç‰¹å¾æå–å¼€é”€)
- **Step 2 (äº‹ä»¶åˆæˆ)**: é¢„è®¡20-40ç§’/åºåˆ— (çº¯æ•°æ®åˆå¹¶)
- **æ€»ä½“æå‡**: é¢„è®¡æ¯”åŸæ¶æ„å¿«40-60% (æ— ç‰¹å¾æå–)
- **å†…å­˜ä½¿ç”¨**: <500MBå³°å€¼ (è§£è€¦é™ä½å†…å­˜å³°å€¼)
- **æ–‡ä»¶å¤§å°**: æ ¹æ®äº‹ä»¶æ•°é‡ï¼Œé€šå¸¸5-15MB/æ–‡ä»¶

### ğŸ¯ æ–°å®¹é‡è§„åˆ’
```bash
# ğŸ†• Debugå¼€å‘ (æ¨è)
Step1: 3-5ç‚«å…‰åºåˆ—
Step2: å¯¹åº”çš„èƒŒæ™¯+åˆå¹¶æ–‡ä»¶
ç”Ÿæˆæ—¶é—´: 5-10åˆ†é’Ÿ
å­˜å‚¨éœ€æ±‚: 50-200MB

# ğŸ†• å°è§„æ¨¡å®éªŒ
Step1: 10-20ç‚«å…‰åºåˆ—  
Step2: å¯¹åº”çš„äº‹ä»¶åˆæˆ
ç”Ÿæˆæ—¶é—´: 20-40åˆ†é’Ÿ
å­˜å‚¨éœ€æ±‚: 200MB-1GB

# ğŸ†• ä¸­ç­‰è§„æ¨¡æ•°æ®é›†
Step1: 100-200ç‚«å…‰åºåˆ—
Step2: å¯¹åº”çš„äº‹ä»¶åˆæˆ
ç”Ÿæˆæ—¶é—´: 2-4å°æ—¶  
å­˜å‚¨éœ€æ±‚: 2-8GB

# ğŸ†• å¤§è§„æ¨¡ç”Ÿäº§
Step1: 1000+ç‚«å…‰åºåˆ—
Step2: å¯¹åº”çš„äº‹ä»¶åˆæˆ
ç”Ÿæˆæ—¶é—´: 8-15å°æ—¶
å­˜å‚¨éœ€æ±‚: 20-100GB
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³
1. **ç¯å¢ƒæœªæ¿€æ´»**: å¿…é¡»ä½¿ç”¨æŒ‡å®šcondaç¯å¢ƒ
2. **DVSä»¿çœŸå™¨è¶…æ—¶**: æ£€æŸ¥simulator/DVS-Voltmeter-main/è·¯å¾„
3. **Flare7Kè·¯å¾„é”™è¯¯**: æ£€æŸ¥é…ç½®ä¸­flare7k_pathè®¾ç½®
4. **H5æ–‡ä»¶ç”Ÿæˆå¤±è´¥**: æ£€æŸ¥data/generated_h5/æƒé™
5. **ç”Ÿæˆé€Ÿåº¦æ…¢**: æ­£å¸¸ç°è±¡ï¼Œå•åºåˆ—éœ€è¦1-3åˆ†é’Ÿ

### ğŸ†• éªŒè¯ç³»ç»Ÿå¥åº·
```bash
# å¿«é€Ÿç³»ç»Ÿæµ‹è¯• (5-10åˆ†é’Ÿ)
python test_new_system.py

# é¢„æœŸè¾“å‡º
âœ… Step 1: Generated 3 flare event files  
âœ… Step 2: Generated 3 background + 3 merged event files
âœ… H5 format compliance verified
âœ… Debug visualizations generated

# æ‰‹åŠ¨æµ‹è¯•æµç¨‹
python main.py --step 1 --debug     # æµ‹è¯•Step 1
python main.py --step 2 --debug     # æµ‹è¯•Step 2
```

### ğŸ†• æ•…éšœæ’é™¤æ­¥éª¤
1. **Step 1å¤±è´¥**: æ£€æŸ¥DVSä»¿çœŸå™¨è·¯å¾„å’ŒFlare7Kæ•°æ®é›†
2. **Step 2å¤±è´¥**: ç¡®ä¿Step 1å·²æˆåŠŸç”Ÿæˆç‚«å…‰äº‹ä»¶æ–‡ä»¶
3. **H5æ ¼å¼é”™è¯¯**: æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶æ˜¯å¦åŒ…å«æ­£ç¡®çš„/events/*ç»“æ„
4. **Debugå¯è§†åŒ–ç¼ºå¤±**: ç¡®ä¿ä½¿ç”¨--debugæ ‡å¿—å¹¶æ£€æŸ¥æƒé™
5. **å†…å­˜ä¸è¶³**: å‡å°‘debug_sequencesæ•°é‡

## ğŸ“‹ é‡è¦æ–‡ä»¶æ¸…å•

### ğŸ†• æ ¸å¿ƒå¿…éœ€æ–‡ä»¶ (æ–°æ¶æ„)
```
# ğŸ†• æ–°æ¶æ„æ ¸å¿ƒæ–‡ä»¶
main.py                               # ä¸¤æ­¥æµç¨‹ä¸»å…¥å£ ğŸ†•
test_new_system.py                    # ç³»ç»Ÿæµ‹è¯•è„šæœ¬ ğŸ†•
configs/config.yaml                   # ä¸¤æ­¥æ¨¡å¼é…ç½® ğŸ”„
src/flare_event_generator.py          # Step1: ç‚«å…‰ç”Ÿæˆå™¨ ğŸ†•
src/event_composer.py                 # Step2: äº‹ä»¶åˆæˆå™¨ ğŸ†•

# å¤ç”¨çš„æ”¯æŒç»„ä»¶
src/flare_synthesis.py                # ç‚«å…‰å›¾åƒåˆæˆ âœ…
src/dvs_flare_integration.py          # DVSä»¿çœŸå™¨é›†æˆ âœ…
src/dsec_efficient.py                 # DSECæ•°æ®åŠ è½½ âœ…
src/event_visualization_utils.py      # Debugå¯è§†åŒ– âœ…
simulator/DVS-Voltmeter-main/         # DVSä»¿çœŸå™¨ âœ…
data/bg_events/                       # DSECèƒŒæ™¯æ•°æ® âœ…
```

### ğŸ—‚ï¸ æ–‡ä»¶çŠ¶æ€è¯´æ˜
```
ğŸ†• æ–°åˆ›å»ºæ–‡ä»¶: å®ç°ä¸¤æ­¥è§£è€¦æ¶æ„
ğŸ”„ ä¿®æ”¹æ–‡ä»¶: é€‚é…æ–°æ¶æ„çš„é…ç½®
âœ… å¤ç”¨æ–‡ä»¶: ä¿æŒåŸæœ‰åŠŸèƒ½ä¸å˜
ğŸ”’ ä¿ç•™æ–‡ä»¶: æ—§æ¶æ„æ–‡ä»¶ä¿ç•™ä½†ä¸å†ä½¿ç”¨ (å¦‚unified_dataset.py)
ğŸ—‘ï¸ æ— éœ€æ–‡ä»¶: feature_extractor.pyç­‰åå¤„ç†ç›¸å…³ (åŠŸèƒ½å·²ç§»é™¤)
ğŸ§ª è¯•éªŒæ–‡ä»¶: R_flare_generator/ä¸­çš„UE5ç›¸å…³ä»£ç  (å¼€å‘ä¸­)
```

## ğŸ†• æ–°æ¶æ„æ ¸å¿ƒä¼˜åŠ¿

### è®¾è®¡ä¼˜åŠ¿å¯¹æ¯”
```
åŸæ¶æ„ (å¤æ‚è€¦åˆ)          â†’    æ–°æ¶æ„ (ä¸¤æ­¥è§£è€¦)
â”œâ”€â”€ å¤æ‚çš„ç‰¹å¾æå–          â†’    âœ… ç§»é™¤ç‰¹å¾æå–ï¼Œè¾“å‡ºåŸå§‹æ•°æ®
â”œâ”€â”€ å¤æ‚çš„æ ‡ç­¾ç”Ÿæˆ          â†’    âœ… ç§»é™¤é€äº‹ä»¶æ ‡ç­¾
â”œâ”€â”€ å•ä½“ç”Ÿæˆæµç¨‹            â†’    âœ… è§£è€¦ä¸ºä¸¤ä¸ªç‹¬ç«‹æ­¥éª¤
â”œâ”€â”€ è°ƒè¯•å›°éš¾                â†’    âœ… æ¯æ­¥ç‹¬ç«‹è°ƒè¯•
â”œâ”€â”€ ä¿®æ”¹åˆæˆç­–ç•¥å›°éš¾        â†’    âœ… Step2å¯ç‹¬ç«‹ä¿®æ”¹åˆæˆç­–ç•¥
â””â”€â”€ ç‰¹å¾æ ¼å¼å›ºå®š            â†’    âœ… æ ‡å‡†DVSæ ¼å¼ï¼Œé€šç”¨æ€§å¼º
```

### ğŸš€ æœªæ¥æ‰©å±•èƒ½åŠ›
- **Step 1**: å¯ç‹¬ç«‹ä¼˜åŒ–ç‚«å…‰ç”Ÿæˆç­–ç•¥ï¼Œä¸å½±å“Step 2
- **Step 2**: å¯å®éªŒä¸åŒçš„äº‹ä»¶åˆæˆç®—æ³• (æ—¶é—´äº¤é”™ã€ç©ºé—´æ··åˆç­‰)
- **è¾“å‡ºæ ¼å¼**: DVSæ ‡å‡†æ ¼å¼å¯ç›´æ¥ç”¨äºå…¶ä»–DVSå·¥å…·é“¾
- **å¹¶è¡Œèƒ½åŠ›**: ä¸¤æ­¥å¯åœ¨ä¸åŒæœºå™¨ä¸Šå¹¶è¡Œè¿è¡Œ

## ğŸ’¡ é‡å¯åå¿«é€Ÿä¸Šæ‰‹

### ğŸ†• æ–°ç³»ç»Ÿå¿«é€ŸéªŒè¯
```bash
# 1. æ¿€æ´»ç¯å¢ƒ
source /home/lanpoknlanpokn/miniconda3/bin/activate event_flare

# 2. å¿«é€Ÿæµ‹è¯• (5-10åˆ†é’Ÿ)
python test_new_system.py

# 3. æ‰‹åŠ¨è°ƒè¯• (åˆ†æ­¥)
python main.py --step 1 --debug
python main.py --step 2 --debug  

# 4. æ£€æŸ¥è¾“å‡º
ls -la output/data/flare_events/
ls -la output/data/bg_events/ 
ls -la output/data/merge_events/
ls -la output/debug/
```

### ğŸ¯ æ–°æ¶æ„æ ¸å¿ƒè®°å¿†ç‚¹
- âœ… **ä¸¤æ­¥è§£è€¦**: Step1ç”Ÿæˆç‚«å…‰ï¼ŒStep2åˆæˆäº‹ä»¶
- âœ… **æ ‡å‡†DVSæ ¼å¼**: `/events/t,x,y,p` åŸå§‹æ•°æ®è¾“å‡º
- âœ… **100msç»Ÿä¸€æ—¶é•¿**: æ‰€æœ‰è¾“å‡ºæ–‡ä»¶æ—¶é—´æˆ³èŒƒå›´0-100ms
- âœ… **éšæœºåŒ–å¢å¼º**: k1å‚æ•°5-16éšæœº, é¢‘ç‡å˜åŒ–Â±20Hz, ç‚«å…‰èµ·å§‹0-20msåç§»
- âœ… **æ— åå¤„ç†**: ç§»é™¤ç‰¹å¾æå–å’Œæ ‡ç­¾ç”Ÿæˆ
- âœ… **ç‹¬ç«‹è°ƒè¯•**: æ¯æ­¥å¯å•ç‹¬è¿è¡Œå’Œè°ƒè¯•ï¼Œdebugè¦†ç›–æ‰€æœ‰åºåˆ—
- âœ… **çµæ´»æ‰©å±•**: ä¾¿äºä¿®æ”¹åˆæˆç­–ç•¥å’Œå‚æ•°

### ğŸ†• æœ€æ–°å‚æ•°è®¾ç½® (2025-08-20 æ›´æ–°)
```yaml
# DVSä»¿çœŸå‚æ•°
k1_randomization: 5.0 - 16.0     # 5-16éšæœºèŒƒå›´ (å¤§å¹…æ‰©å±•äº‹ä»¶æ•°é‡å˜åŒ–èŒƒå›´)
flare_frequency: 100-120Hz Â± 20Hz # 80-140Hzæ€»èŒƒå›´ (æ›´å¤§é¢‘ç‡å˜åŒ–)

# æ—¶é—´çº¿è®¾è®¡  
flare_duration: 30-80ms          # ç‚«å…‰æŒç»­æ—¶é—´
flare_start_offset: 0-20ms       # éšæœºèµ·å§‹åç§»
background_duration: 100ms       # å›ºå®šèƒŒæ™¯é•¿åº¦
total_sequence_length: 100ms     # ç»Ÿä¸€è¾“å‡ºé•¿åº¦

# Debugè®¾ç½®
debug_all_sequences: true        # æ‰€æœ‰åºåˆ—éƒ½æœ‰debugè¾“å‡º
visualization_colors: red/blue   # ç»Ÿä¸€ææ€§é¢œè‰²ç¼–ç 
temporal_scales: [0.5,1,2,4]x   # å¤šåˆ†è¾¨ç‡æ—¶é—´åˆ†æ

# ğŸ†• ç‚«å…‰ç§»åŠ¨è®¾å®š
flare_movement_amplitude: 0-180px # æœ€å¤§ç§»åŠ¨180åƒç´  (~28%ç”»é¢å®½åº¦)
initial_position_translate: 20%   # åˆå§‹ä½ç½®å¹³ç§»èŒƒå›´
boundary_margin: 50px             # è¾¹ç•Œä¿æŠ¤åŒºåŸŸ
```

## ğŸ“ TODO - æœªæ¥é‡å¤§æ¶æ„æ”¹åŠ¨è®¡åˆ’

### ğŸš€ Step 1 æ‰©å±•è®¡åˆ’ï¼šåŒäº‹ä»¶ç”Ÿæˆ
**ç›®æ ‡**: ç‚«å…‰äº‹ä»¶ + å…‰æºäº‹ä»¶åŒè¾“å‡º
- **ç°çŠ¶**: åªç”Ÿæˆçº¯ç‚«å…‰äº‹ä»¶ â†’ `output/data/flare_events/*.h5`
- **è®¡åˆ’**: 
  - ä¿æŒç‚«å…‰äº‹ä»¶ç”Ÿæˆä¸å˜
  - **æ–°å¢**: åŒæ—¶ç”Ÿæˆå…‰æºäº‹ä»¶ â†’ `output/data/light_source_events/*.h5`
  - **å…³é”®è¦æ±‚**: å…‰æºå¼ºåº¦å˜åŒ–ä¸ä½ç§»å¿…é¡»ä¸ç‚«å…‰**å®Œå…¨ä¸€è‡´**
  - **æ•°æ®æº**: Flare7Kæ•°æ®é›†ä¸­çš„å…‰æºå›¾ç‰‡æ–‡ä»¶å¤¹
  - **è¾“å‡ºæ ¼å¼**: åŒæ ·çš„æ ‡å‡†DVSæ ¼å¼ `/events/t,x,y,p`
  - **æ–‡ä»¶å‘½å**: ä¸ç‚«å…‰äº‹ä»¶åŒåï¼Œå¦‚ `flare_sequence_xxx.h5` â†’ `light_source_sequence_xxx.h5`

### ğŸ”„ Step 2 é‡å¤§é‡æ„è®¡åˆ’ï¼šæ™ºèƒ½äº‹ä»¶åˆæˆ
**ç›®æ ‡**: ä»ç®€å•ç›¸åŠ æ”¹ä¸ºå¤æ‚ç‚«å…‰å»é™¤åœºæ™¯
- **ç°çŠ¶**: ç®€å•çš„äº‹ä»¶ç›¸åŠ  `èƒŒæ™¯ + ç‚«å…‰ â†’ åˆå¹¶`
- **è®¡åˆ’**:
  - **è¾“å…¥å˜åŒ–**: 
    - èƒŒæ™¯äº‹ä»¶ (DSEC)
    - ç‚«å…‰äº‹ä»¶ (Step1è¾“å‡º)
    - **æ–°å¢**: å…‰æºäº‹ä»¶ (Step1è¾“å‡º)
  - **åˆæˆç­–ç•¥å˜åŒ–**:
    - èƒŒæ™¯äº‹ä»¶ â‰  çº¯èƒŒæ™¯ï¼Œè€Œæ˜¯ `èƒŒæ™¯ + å…‰æºäº‹ä»¶`
    - åˆå¹¶äº‹ä»¶ = `(èƒŒæ™¯ + å…‰æº) + ç‚«å…‰`
    - **æ ¸å¿ƒç›®çš„**: ä¸ºç‚«å…‰å»é™¤ä»»åŠ¡åšå‡†å¤‡ï¼Œç¡®ä¿å»é™¤ç‚«å…‰æ—¶ä¸ä¼šè¯¯åˆ å…‰æº
  - **è¾“å‡ºè°ƒæ•´**:
    - `bg_events/` â†’ `background_with_light_source_events/` (èƒŒæ™¯+å…‰æº)
    - `merge_events/` â†’ `full_scene_events/` (èƒŒæ™¯+å…‰æº+ç‚«å…‰)

### ğŸ¯ æ¶æ„æ”¹åŠ¨çš„æ ¸å¿ƒä»·å€¼
```mermaid
graph TD
    subgraph "å½“å‰æ¶æ„ (ç®€å•ç›¸åŠ )"
        A1[èƒŒæ™¯äº‹ä»¶] --> C1[ç®€å•ç›¸åŠ ]
        B1[ç‚«å…‰äº‹ä»¶] --> C1
        C1 --> D1[åˆå¹¶äº‹ä»¶]
    end
    
    subgraph "æœªæ¥æ¶æ„ (ç‚«å…‰å»é™¤åœºæ™¯)"
        A2[èƒŒæ™¯äº‹ä»¶] --> C2[æ™ºèƒ½åˆæˆ]
        B2[å…‰æºäº‹ä»¶] --> C2
        E2[ç‚«å…‰äº‹ä»¶] --> C3[æœ€ç»ˆåˆæˆ]
        C2 --> F2[èƒŒæ™¯+å…‰æº]
        F2 --> C3
        C3 --> G2[å®Œæ•´åœºæ™¯]
        
        F2 -.->|è®­ç»ƒç›®æ ‡| H2[ç‚«å…‰å»é™¤æ¨¡å‹]
        G2 -.->|è¾“å…¥| H2
    end
```

### âš ï¸ å®ç°æ³¨æ„äº‹é¡¹
1. **Step 1 ä¿®æ”¹**:
   - éœ€è¦è¯»å–Flare7Kå…‰æºå›¾ç‰‡æ–‡ä»¶å¤¹ç»“æ„
   - ç¡®ä¿å…‰æºä¸ç‚«å…‰çš„æ—¶é—´åŒæ­¥å’Œç©ºé—´ä¸€è‡´æ€§
   - DVSä»¿çœŸå™¨éœ€è¦åŒæ—¶å¤„ç†ä¸¤ç§å›¾åƒåºåˆ—

2. **Step 2 ä¿®æ”¹**:
   - é‡æ–°è®¾è®¡äº‹ä»¶åˆæˆé€»è¾‘
   - ç¡®ä¿å…‰æºäº‹ä»¶ä¸ä¼šåœ¨å»ç‚«å…‰è¿‡ç¨‹ä¸­è¢«è¯¯åˆ 
   - å¯èƒ½éœ€è¦æ—¶é—´æˆ³å¯¹é½å’Œç©ºé—´æ³¨å†Œ

3. **æ•°æ®æ ¼å¼å…¼å®¹æ€§**:
   - ä¿æŒç°æœ‰DVS H5æ ¼å¼ä¸å˜
   - Debugå¯è§†åŒ–éœ€è¦æ”¯æŒä¸‰ç§äº‹ä»¶ç±»å‹æ˜¾ç¤º
   - æ–‡ä»¶å‘½åè§„èŒƒéœ€è¦æ˜ç¡®åŒºåˆ†

### ğŸ”„ è¿ç§»è®¡åˆ’
- **é˜¶æ®µ1**: ä¿æŒå½“å‰ç³»ç»Ÿç¨³å®šè¿è¡Œ
- **é˜¶æ®µ2**: æ‰©å±•Step 1æ”¯æŒå…‰æºäº‹ä»¶ç”Ÿæˆ
- **é˜¶æ®µ3**: é‡æ„Step 2äº‹ä»¶åˆæˆç­–ç•¥
- **é˜¶æ®µ4**: å®Œæ•´æµ‹è¯•å’Œdebugå¯è§†åŒ–é€‚é…

## ğŸ¯ GLSLåå°„ç‚«å…‰ç”Ÿæˆå™¨å®Œæ•´è§£å†³æ–¹æ¡ˆ (2025-08-22)

### âœ… å®Œæ•´å››ç‰ˆæœ¬æ¶æ„ï¼šä»CPUåˆ°GPUçš„å®Œæ•´è§£å†³æ–¹æ¡ˆ

#### ğŸ¯ ç‰ˆæœ¬å¯¹æ¯”è¡¨
| ç‰ˆæœ¬ | æŠ€æœ¯æ ˆ | æ€§èƒ½ (640x480) | çŠ¶æ€ | é€‚ç”¨åœºæ™¯ |
|------|-------|--------------|------|---------|
| **GLSL_flare.py** | ModernGL + GLSL | >100 FPS | âœ… ç”Ÿäº§ | Windowså®æ—¶æ¸²æŸ“ |
| **perfect_python.py** | NumPyå‘é‡åŒ– | 2.26 FPS | âœ… å¤‡é€‰ | CPUç¯å¢ƒ |
| **perfect_gpu.py** | PyTorch CUDA | 9.97 FPS | âœ… å¤‡é€‰ | WSL/Linux GPU |
| **ultra_fast_gpu.py** ğŸ† | æè‡´ä¼˜åŒ–CUDA | **11.70 FPS** | âœ… **æ¨è** | **æœ€ä½³WSLæ€§èƒ½** |

#### ğŸš€ æè‡´ä¼˜åŒ–ç‰ˆæœ¬æ ¸å¿ƒä¼˜åŠ¿ (2025-08-22)
```python
# ğŸ† æè‡´ä¼˜åŒ–ç‰ˆæœ¬ (æ¨è) - GLSL_flare_ultra_fast_gpu.py
generator = FlareGeneratorUltraFastGPU(output_size=(640, 480))
img = generator.generate(
    light_pos=(320, 240),
    noise_image_path="texture.jpg", 
    time=10.0,                    # seedå‚æ•°æ§åˆ¶å˜åŒ–
    flare_size=0.2,              # ç‚«å…‰å°ºå¯¸
    generate_main_glow=False,     # ä¸“æ³¨åå°„ç‚«å…‰  
    generate_reflections=True     # ä¸»è¦ç‰¹æ•ˆ
)
# âš¡ æ€§èƒ½: 11.70 FPSï¼Œ16.7å€æ€»ä½“åŠ é€Ÿï¼Œä¿æŒç®—æ³•å®Œæ•´æ€§ï¼
```

#### ğŸ”§ æè‡´ä¼˜åŒ–æŠ€æœ¯è¦ç‚¹ (2025-08-22)
**åœ¨ä¿æŒç®—æ³•å®Œæ•´æ€§å‰æä¸‹çš„æ€§èƒ½æå‡**ï¼š
1. **é¢„è®¡ç®—ä¼˜åŒ–** âœ…
   - UVåæ ‡ç½‘æ ¼é¢„è®¡ç®—
   - å¼ é‡é¢„åˆ†é…é¿å…åŠ¨æ€å†…å­˜
   - æ‰¹é‡å™ªå£°é‡‡æ ·
   
2. **å‘é‡åŒ–æ”¹è¿›** âœ…
   - åŒé‡å¾ªç¯å®Œå…¨å‘é‡åŒ–
   - å‡å°‘CPU-GPUæ•°æ®ä¼ è¾“
   - çº¹ç†ç¼“å­˜å¤ç”¨
   
3. **ç®—æ³•ä¿æŒ** âœ…  
   - 20ä¸ªå®Œæ•´åå°„è®¡ç®—
   - åŸå§‹GLSLç®—æ³•é€»è¾‘ä¸å˜
   - 100%è§†è§‰æ•ˆæœä¿çœŸåº¦

#### ğŸ“ å®Œæ•´æ–‡ä»¶ç»“æ„
```
R_flare_generator/
â”œâ”€â”€ GLSL_flare.py                         # WindowsåŸç”ŸGPUç‰ˆæœ¬
â”œâ”€â”€ GLSL_flare_perfect_cpu.py             # æ·˜æ±°ï¼šNumba CPUç‰ˆæœ¬  
â”œâ”€â”€ GLSL_flare_perfect_python.py          # NumPyå‘é‡åŒ–ç‰ˆæœ¬
â”œâ”€â”€ GLSL_flare_perfect_gpu.py             # ğŸ† PyTorch GPUç‰ˆæœ¬ (æ¨è)
â”œâ”€â”€ generate_procedural_noise.py          # å™ªå£°çº¹ç†ç”Ÿæˆå™¨
â”œâ”€â”€ test_light_continuity.py              # è¿ç»­æ€§æµ‹è¯•è„šæœ¬
â”œâ”€â”€ performance_comparison.py             # æ€§èƒ½å¯¹æ¯”æµ‹è¯•
â”œâ”€â”€ noise_textures/                       # 500+å™ªå£°çº¹ç†åº“
â”œâ”€â”€ R_flare_diversity_test_50/            # 50å¼ å¤šæ ·æ€§æµ‹è¯•
â”œâ”€â”€ R_flare_light_continuity_test/        # 50å¼ è¿ç»­æ€§æµ‹è¯•
â””â”€â”€ R_flare_fixed_algorithm_test/         # ç®—æ³•ä¿®å¤éªŒè¯
```

#### ğŸ¯ æ¨èä½¿ç”¨æ–¹æ¡ˆ (2025-08-22 æ›´æ–°)
```bash
# ç¯å¢ƒæ¿€æ´»
source /home/lanpoknlanpokn/miniconda3/bin/activate event_flare

# ğŸ† é¦–é€‰ï¼šæè‡´ä¼˜åŒ–GPUç‰ˆæœ¬ (WSLç¯å¢ƒ)
python GLSL_flare_ultra_fast_gpu.py   # 11.70 FPSï¼Œæœ€ä½³å¹³è¡¡ï¼

# å¤‡é€‰ï¼šWindowsåŸç”Ÿç‰ˆæœ¬  
python GLSL_flare.py                  # >100 FPSï¼Œéœ€è¦ModernGL

# å…¶ä»–å¤‡é€‰æ–¹æ¡ˆ
python GLSL_flare_perfect_gpu.py      # 9.97 FPSï¼ŒåŸºç¡€GPUç‰ˆæœ¬
python GLSL_flare_perfect_python.py   # 2.26 FPSï¼ŒCPUå¤‡é€‰
```

#### ğŸ“Š æ€§èƒ½ä¼˜åŒ–è®°å½• (2025-08-22)
```
åŸç‰ˆCPU (0.7 FPS) â†’ æè‡´ä¼˜åŒ–GPU (11.70 FPS)
æ€»ä½“æå‡: 16.7å€åŠ é€Ÿ âš¡
ä¿æŒå®Œæ•´æ€§: 20ä¸ªå®Œæ•´åå°„ï¼Œ100%ç®—æ³•ä¿çœŸ
æœ€ä½³å¹³è¡¡: æ€§èƒ½æå‡ + ç®—æ³•å®Œæ•´æ€§
```

### ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ
```
æµ‹è¯•é…ç½®: 320x240 åƒç´ 
Windows GLSLç‰ˆæœ¬: >100 FPS (å®æ—¶çº§åˆ«)
WSL CPUç‰ˆæœ¬: 0.7 FPS (ç›¸å¯¹æ•ˆç‡ 0.7%)

ç»“è®º:
âœ… CPUç‰ˆæœ¬å®Œç¾å¤åˆ»GLSLç®—æ³•å’Œè§†è§‰æ•ˆæœ
âœ… è§£å†³äº†WSLä¸­ModernGLæ— æ³•è¿è¡Œçš„é—®é¢˜  
âš ï¸  CPUç‰ˆæœ¬é€‚åˆç¦»çº¿æ‰¹é‡ç”Ÿæˆï¼Œä¸é€‚åˆå®æ—¶åº”ç”¨
```

### ğŸ”„ ç°æœ‰ç³»ç»Ÿé›†æˆç­–ç•¥ (ä¸æ›¿æ¢ç°æœ‰æ–¹æ³•)
- **Flare7Kæ•°æ®é›†**: ç»§ç»­ç”¨äºæ•£å°„ç±»å‹ç‚«å…‰ç”Ÿæˆ
- **GLSLç”Ÿæˆå™¨**: ä¸“é—¨è¡¥å……åå°„ç±»å‹ç‚«å…‰
- **ç¯å¢ƒè‡ªé€‚åº”**: Windowsç”¨GPUç‰ˆæœ¬ï¼ŒWSLç”¨CPUç‰ˆæœ¬
- **æœ€ç»ˆç›®æ ‡**: åœ¨äº‹ä»¶åˆæˆé˜¶æ®µæ··åˆæ•£å°„+åå°„ç‚«å…‰ç±»å‹

---

## ğŸš€ æ•£å°„+åå°„ç‚«å…‰èåˆç³»ç»Ÿ (2025-08-22 é‡å¤§çªç ´)

### âœ… å®Œæ•´ç‚«å…‰ç”Ÿæˆæµç¨‹å®ç°
**æ ¸å¿ƒåˆ›æ–°**ï¼šåœ¨ç°æœ‰æ•£å°„ç‚«å…‰åŸºç¡€ä¸Šï¼Œå®æ—¶æ£€æµ‹å…‰æºå¹¶ç”Ÿæˆåå°„ç‚«å…‰è¿›è¡Œèåˆ
```
Flare7Kæ•£å°„ç‚«å…‰ â†’ å…‰æºæ£€æµ‹ â†’ GLSLåå°„ç‚«å…‰ç”Ÿæˆ â†’ èåˆå åŠ  â†’ å®Œæ•´ç‚«å…‰è§†é¢‘ â†’ DVSä»¿çœŸ
```

**å…³é”®æŠ€æœ¯å®ç°** (src/flare_synthesis.py:640-668è¡Œ):
1. **å…‰æºæ£€æµ‹**: ä»æ•£å°„ç‚«å…‰å¸§ä¸­æå–æœ€äº®10ä¸ªåƒç´ çš„å¹³å‡ä½ç½®å’Œé¢œè‰²
2. **åå°„ç”Ÿæˆ**: ä½¿ç”¨GLSL_flare_ultra_fast_gpuå®æ—¶ç”Ÿæˆåå°„ç‚«å…‰
3. **å¼ºåº¦åŒæ­¥**: åå°„ç‚«å…‰ä½¿ç”¨ä¸æ•£å°„ç‚«å…‰ç›¸åŒçš„é¢‘é—ªç³»æ•°A
4. **èåˆå åŠ **: ç®€å•ç›¸åŠ èåˆï¼Œç”Ÿæˆå®Œæ•´ç‚«å…‰æ•ˆæœ

**æ€§èƒ½ä¼˜åŒ–** (2025-08-22):
- **è¶…æ—¶ä¿®å¤**: DVSä»¿çœŸå™¨è¶…æ—¶ä»60så¢åŠ åˆ°300sï¼Œæ”¯æŒå¤æ‚åå°„ç‚«å…‰ç”Ÿæˆ
- **k1å‚æ•°åˆ†å¸ƒä¼˜åŒ–**: æ”¹ä¸ºéç­‰æ¦‚ç‡åˆ†å¸ƒ
  - 50%æ¦‚ç‡: k1 âˆˆ [5.0, 7.0] (ä½æ•æ„Ÿåº¦ï¼Œäº‹ä»¶ç¨€ç–)
  - 50%æ¦‚ç‡: k1 âˆˆ [7.0, 16.0] (é«˜æ•æ„Ÿåº¦ï¼Œäº‹ä»¶å¯†é›†)
  - é¿å…äº†åŸæ¥ç­‰æ¦‚ç‡åˆ†å¸ƒå¯¹é«˜æ•æ„Ÿåº¦çš„åå‘

**é›†æˆçŠ¶æ€**: âš ï¸ å­˜åœ¨ä¸¥é‡é—®é¢˜éœ€è¦ä¿®å¤
- âœ… GLSLç”Ÿæˆå™¨è‡ªåŠ¨åˆå§‹åŒ–ï¼Œæ”¯æŒ411ç§å™ªå£°çº¹ç†
- âœ… å…‰æºæ£€æµ‹ç®—æ³•é²æ£’ï¼Œå¤„ç†å„ç§äº®åº¦æ¡ä»¶
- âœ… é”™è¯¯å¤„ç†å®Œå–„ï¼ŒGLSLå¤±è´¥ä¸å½±å“æ•£å°„ç‚«å…‰ç”Ÿæˆ
- âœ… **é—®é¢˜å·²ä¿®å¤**: åå°„ç‚«å…‰è¿ç»­æ€§é—®é¢˜è§£å†³ (2025-08-22)
  - **é—®é¢˜æ ¹æº**: 
    - time_seed = random.random() * 50 â†’ æ¯å¸§å®Œå…¨éšæœº
    - noise_texture = random.choice() â†’ æ¯å¸§éšæœºçº¹ç†  
    - flare_size = random.uniform() â†’ æ¯å¸§éšæœºå°ºå¯¸
  - **ä¿®å¤æ–¹æ¡ˆ**: åºåˆ—çº§å›ºå®šå‚æ•° + å›ºå®šç§å­ï¼ˆå…³é”®è®¤çŸ¥ä¿®æ­£ï¼‰
    - sequence_noise_texture: æ•´ä¸ªåºåˆ—ä½¿ç”¨åŒä¸€çº¹ç†
    - sequence_flare_size: æ•´ä¸ªåºåˆ—ä½¿ç”¨åŒä¸€å°ºå¯¸  
    - sequence_time_seed: æ•´ä¸ªåºåˆ—ä½¿ç”¨å›ºå®šç§å­ï¼ˆéè¿ç»­æ—¶é—´ï¼ï¼‰
    - **æ ¸å¿ƒç†è§£**: timeå‚æ•°æ˜¯éšæœºç§å­ï¼Œåº”ä¿æŒå›ºå®šï¼›åªæœ‰light_poså˜åŒ–å®ç°å¹³æ»‘ç§»åŠ¨
  - **ä¿®å¤æ–‡ä»¶**: src/flare_synthesis.py:592-668, æ–°å¢_generate_reflection_flare_continuous()
  - **éªŒè¯**: å‚ç…§test_light_continuity_center.pyçš„è¿ç»­æ€§è¡¨ç°

### ğŸ¯ éªŒè¯ç»“æœ
```bash
# æˆåŠŸè¾“å‡ºç¤ºä¾‹
Frame 0: Added reflection flare at (167, 469), color=['0.84', '0.84', '0.84'], intensity=0.992
Frame 1: Added reflection flare at (167, 469), color=['0.84', '0.84', '0.84'], intensity=0.992
Random k1: 6.234 (range: 5.0-16.0)  # æ–°çš„åˆ†å¸ƒå·²ç”Ÿæ•ˆï¼Œk1è¶Šé«˜äº‹ä»¶è¶Šå¤š
```

**è¾“å‡ºæ–‡ä»¶éªŒè¯**: 
- ç”ŸæˆH5äº‹ä»¶æ–‡ä»¶: `output/data/flare_events/*.h5`
- Debugå¯è§†åŒ–: `output/debug/flare_generation/*/events_temporal_*x/`
- æ¯å¸§åŒ…å«å®Œæ•´çš„æ•£å°„+åå°„ç‚«å…‰èåˆæ•ˆæœ

*æœ€æ–°æ›´æ–°: 2025-08-22 - æ•£å°„+åå°„ç‚«å…‰èåˆç³»ç»Ÿå®Œæˆï¼Œæ€§èƒ½ä¼˜åŒ–å’Œk1åˆ†å¸ƒæ”¹è¿›*
*å†å²æ›´æ–°: 2025-08-20 - k1å‚æ•°æ‰©å±•åˆ°5-16éšæœºèŒƒå›´ï¼ŒåŠ å¼ºäº‹ä»¶æ•°é‡å¤šæ ·æ€§*
*TODOæ·»åŠ : 2025-08-20 - åŒäº‹ä»¶ç”Ÿæˆä¸æ™ºèƒ½åˆæˆæ¶æ„æ”¹åŠ¨è§„åˆ’*