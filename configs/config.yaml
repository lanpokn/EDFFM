run:
  mode: train
  experiment_name: event_denoising_mamba_v1

data_pipeline:
  mode: 'load'
  h5_archive_path: 'data/generated_h5'
  num_workers: 0

data:
  dsec_path: "data/bg_events"
  flare7k_path: "/mnt/e/2025/physical_deflare/Datasets/Flare7Kpp/Flare7Kpp"
  
  event_simulator:
    type: "dvs_voltmeter"
    
    dvs_voltmeter:
      simulator_path: "/mnt/e/2025/event_flick_flare/main/simulator/DVS-Voltmeter-main"
      timeout_sec: 60
      
      parameters:
        dvs346_k: [2.5, 20, 0.0001, 1e-7, 5e-9, 0.00001]
        dvs240_k: [4.424, 23, 0.0002, 1e-7, 5e-8, 0.00001]
      
    v2ce:
      model_path: "/mnt/e/2025/event_flick_flare/main/simulator/V2CE-Toolbox-master/weights/v2ce_3d.pt"
      toolbox_path: "/mnt/e/2025/event_flick_flare/main/simulator/V2CE-Toolbox-master"
      seq_len: 16
      infer_type: "center"
      batch_size: 1
      height: 260
      width: 346
      
      base_fps: 200
      max_fps: 1600
      min_samples_per_cycle: 8
      fps_scale_factor: 1.5
      
      ceil: 10
      upper_bound_percentile: 98
    
    iebcs:
      simulator_path: "/mnt/e/2025/event_flick_flare/main/simulator/IEBCS-main"
      timeout_sec: 60
      
      sensor_parameters:
        th_pos: 0.4
        th_neg: 0.4
        th_noise: 0.01
        latency: 100
        tau: 40
        jitter: 10
        bgnp: 0.1
        bgnn: 0.01
        refractory: 100
        dt: 500
        
      frame_generation:
        min_samples_per_cycle: 12
        max_fps: 600
        base_fps: 300
        
      debug_visualization:
        enable_multi_timewindow: true
        time_window_scales: [0.5, 1, 2, 4]
        temporal_subdivisions: 5
        
      noise_model:
        enable_measured_noise: false
        noise_pos_file: "data/noise_pos_161lux.npy"
        noise_neg_file: "data/noise_neg_161lux.npy"
  
  randomized_training:
    background_duration_range: [0.05, 0.1]
    background_contains_flare_prob: 0.75
    flare_only_prob: 0.1
    background_only_prob: 0.15
    
  flare_synthesis:
    realistic_frequencies:
      power_50hz: 100.0
      power_60hz: 120.0
      japan_east: 100.0
      japan_west: 120.0
    
    frequency_variation: 5.0
    min_samples_per_cycle: 48
    max_fps: 6000
    
    flicker_curves: ["sine", "square", "triangle", "exponential"]
    position_random: true
    intensity_scale: [0.8, 1.2]
    duration_range: [0.03, 0.08]
    min_intensity_baseline: [0.0, 0.7]
    max_intensity: 1.0
  
  time_window_us: 1000000
  resolution_h: 480
  resolution_w: 640
  sequence_length: 64
  num_workers: 0
  max_samples_debug: 4

model:
  input_feature_dim: 4
  d_model: 512
  d_state: 64
  d_conv: 4
  expand: 4
  n_layers: 12

feature_extractor:
  pfd_time_window: 25000
  pfd_neighborhood_size: 3
  coarse_time_window: 2000
  coarse_support_threshold: 1
  coarse_neighborhood_size: 3
  fine_time_window: 30000
  fine_neighborhood_size: 3

training:
  epochs: 20
  learning_rate: 0.0005
  checkpoint_dir: "./checkpoints"
  chunk_size: 8192
  num_long_sequences_per_epoch: 500
  validate_every_n_steps: 5000
  save_every_n_steps: 5000

evaluation:
  checkpoint_path: "./checkpoints/best_model.pth"
  num_long_sequences_per_epoch: 50